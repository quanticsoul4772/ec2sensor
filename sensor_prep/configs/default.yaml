# Default EC2 Sensor Configuration
# Standard configuration for general testing and development

name: default
description: Standard EC2 sensor configuration for general testing

# AWS Configuration
aws:
  ami_id: ami-0d2ba411d9fd7f677  # BroLin 28.0.6 release
  instance_type: m6a.2xlarge
  disk_space: 500gb
  region: us-east-1

# Sensor Metadata
sensor:
  team: platform
  branch: testing
  username: ${USER}  # Will be replaced with actual username
  use_type: TEMPORARY

# Network Interfaces
interfaces:
  eth0: management  # Management and API access
  eth1: monitor     # Packet capture and monitoring

# Sensor Features to Enable
# These will be applied after sensor creation via broala-config
features:
  http_access: true       # Enable HTTP API access
  yara: true             # Enable YARA file scanning
  suricata: true         # Enable Suricata IDS/IPS
  smartpcap: true        # Enable SmartPCAP packet capture

# BroLin Configuration Commands
# Applied via: sudo broala-config set <key>=<value>
brolin_config:
  http.access.enable: 1
  license.yara.enable: 1
  license.suricata.enable: 1
  license.smartpcap.enable: 1

# Packages to Install (via sensor_prep/packages/)
packages:
  - base_testing_tools    # jq, wget, curl, netcat, tcpdump

# Snapshots
snapshots:
  create_baseline: true   # Create snapshot after preparation
  baseline_name: "default-baseline"

# Post-deployment Validation
validation:
  - command: "sudo corelightctl sensor status"
    expected: "running"
  - command: "sudo broala-config get http.access.enable"
    expected: "1"
  - command: "sudo broala-config get license.yara.enable"
    expected: "1"

# Test Scenarios
test_scenarios:
  - Basic sensor functionality
  - API access verification
  - Log generation and export
  - Network traffic monitoring

# Notes
notes: |
  This is the default configuration suitable for most testing scenarios.
  Features enabled: HTTP Access, YARA, Suricata, SmartPCAP

  After deployment, wait 2-3 minutes for services to restart after
  applying configuration changes.
